@model HostelMealManagement.Application.CommonModel.FilterViewModel
@{
    ViewData["Title"] = "Reports";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<style>
    /* ===== BASE (FROM MEMBERS LIST) ===== */
    body {
        background: #f5f7fb !important;
        font-family: "Segoe UI", sans-serif;
    }

    .page-title {
        color: #1f2937;
        font-weight: 700;
        margin-bottom: 18px;
    }

    /* ===== CARD (SAME AS TABLE WRAPPER) ===== */
    .filter-card {
        background: #ffffff;
        padding: 24px;
        border-radius: 16px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 12px 35px rgba(0,0,0,0.08);
    }

    /* ===== INPUTS ===== */
    .form-select,
    .form-control {
        border-radius: 10px;
        padding: 12px 14px;
        font-size: 14.5px;
        border: 1px solid #d1d5db;
        transition: 0.25s ease;
    }

        .form-select:focus,
        .form-control:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 4px rgba(37,99,235,0.15);
        }

    /* ===== BUTTON BASE (CONSISTENT) ===== */
    .btn-apply,
    .btn-pdf {
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-size: 15px;
        font-weight: 600;
        border-radius: 10px;
        padding: 0 22px;
        line-height: 1;
        border: none !important;
        color: #fff !important;
        transition: 0.3s ease;
    }

    /* ===== APPLY BUTTON (PRIMARY – SAME AS ADD NEW MEMBER) ===== */
    .btn-apply {
        background: linear-gradient(135deg, #2563eb, #1e40af) !important;
        box-shadow: 0 8px 20px rgba(37,99,235,0.35);
    }

        .btn-apply:hover {
            background: linear-gradient(135deg, #1e40af, #1e3a8a) !important;
            box-shadow: 0 10px 28px rgba(37,99,235,0.45);
            transform: translateY(-1px);
        }

    /* ===== PDF BUTTON (DELETE STYLE FROM MEMBERS LIST) ===== */
    .btn-pdf {
        background: linear-gradient(135deg, #ef4444, #b91c1c) !important;
        box-shadow: 0 6px 16px rgba(239,68,68,0.35);
    }

        .btn-pdf:hover {
            background: linear-gradient(135deg, #dc2626, #991b1b) !important;
            box-shadow: 0 8px 22px rgba(239,68,68,0.45);
            transform: translateY(-1px);
        }

    /* ===== BUTTON ROW ===== */
    .btn-row {
        margin-top: 18px;
        display: flex;
        gap: 16px;
        justify-content: flex-end;
    }

    /* ===== RESULT CARD ===== */
    #loadData {
        margin-top: 28px;
        background: #ffffff;
        padding: 22px;
        border-radius: 16px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 12px 35px rgba(0,0,0,0.08);
        min-height: 50px;
    }
</style>

<div class="container-fluid mt-3">

    <h4 class="page-title">Meal Bill Report</h4>

    <!-- FILTER FORM -->
    <form method="post" class="filter-card">
        @Html.AntiForgeryToken()

        <!-- 🔹 ROW 1 : INPUTS -->
        <div class="row g-3">
            <div class="col-lg-4 col-md-6">
                <select asp-for="SelectedMember"
                        asp-items="ViewBag.Members"
                        class="form-select">
                    <option value="">Name of Member</option>
                </select>
            </div>

            <div class="col-lg-4 col-md-6">
                <input asp-for="MemberCodeNo"
                       class="form-control"
                       placeholder="Member ID No." />
            </div>

            <div class="col-lg-4 col-md-6">
                <select asp-for="MealCycleId"
                        asp-items="ViewBag.MealCycle"
                        class="form-select">
                    <option value="">Select Meal Cycle</option>
                </select>
            </div>
        </div>

        <!-- 🔹 ROW 2 : BUTTONS (UNCHANGED POSITION) -->
        <div class="btn-row">
            <button type="button"
                    id="btnApply"
                    class="btn btn-apply">
                <i class="bi bi-check-circle"></i> Apply
            </button>

            <button type="submit"
                    formaction="@Url.Action("MealBillReportPdf", "MealBill")"
                    formtarget="_blank"
                    class="btn btn-pdf">
                <i class="bi bi-file-earmark-pdf"></i> PDF
            </button>
        </div>
    </form>
</div>

<!-- RESULT -->
<div id="loadData"></div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function () {

            $("#btnApply").click(function () {

                var formData = {
                    SelectedMember: $("#SelectedMember").val(),
                    MemberCodeNo: $("#MemberCodeNo").val(),
                    MealCycleId: $("#MealCycleId").val(),
                    __RequestVerificationToken: $('input[name="__RequestVerificationToken"]').val()
                };

                $.ajax({
                    url: '@Url.Action("MealBillReportView", "MealBill")',
                    type: 'POST',
                    data: formData,
                    success: function (response) {
                        $("#loadData").html(response);
                    },
                    error: function () {
                        alert("Error loading data");
                    }
                });
            });

        });
    </script>
}
